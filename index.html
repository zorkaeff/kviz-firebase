<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="UTF-8">
<title>Multiplayer Turnir Kviz</title>
<link rel="icon" href="data:,">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Arial; background:#111; color:white; text-align:center; }
button { margin:4px; padding:8px 12px; font-size:16px; cursor:pointer; }
.hidden { display:none; }
.timer { font-size:32px; margin:10px; }
#leaderboardTable { margin:auto; margin-top:20px; color:white; border-collapse: collapse; }
#leaderboardTable th, #leaderboardTable td { border:1px solid white; padding:4px 8px; }
.correct { color: #0f0; }
.wrong { color: #f33; }
</style>
</head>
<body>

<h2 id="questionText">Čekanje na početak kviza...</h2>
<p id="lobbyInfo">Čekanje na početak kviza...</p>
<p id="roundInfo">Krug: - | Pitanje: -</p>
<p id="valueInfo">Točan ! odgovor: -</p>
<div class="timer" id="timer">00</div>
<div id="answerButtons" class="hidden"></div>

<h3>Trenutni poredak</h3>
<table id="leaderboardTable">
  <thead>
    <tr>
      <th>Poredak</th>
      <th>Igrač</th>
      <th>Bodovi</th>
      <th>! odgovori</th>
      <th>? odgovori</th>
      <th>Vrijeme (s)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<canvas id="scoreChart" width="600" height="300"></canvas>

<script>
/* ===================== FIREBASE ===================== */
const firebaseConfig = {
  apiKey: "AIzaSyB5jeu860fNmmysc51wcb5fej7Bz_6gW-Q",
  authDomain: "hpddd-b9bef.firebaseapp.com",
  databaseURL: "https://hpddd-b9bef-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "hpddd-b9bef",
  storageBucket: "hpddd-b9bef.appspot.com",
  messagingSenderId: "520105963434",
  appId: "1:520105963434:web:5b25d1f9f28512ae1145d3"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ===================== ANONYMOUS AUTH ===================== */
let playerName, uid;
firebase.auth().signInAnonymously()
  .then(() => {
    uid = firebase.auth().currentUser.uid;
    if(!localStorage.getItem("playerName")){
      do { playerName = prompt("Unesi ime igrača:")?.trim(); } while(!playerName);
      localStorage.setItem("playerName", playerName);
    }
    playerName = localStorage.getItem("playerName");

    db.ref("tournament/players/"+uid).set({
      name: playerName,
      joinedAt: Date.now(),
      totalPoints:0,
      usedExclam:0,
      usedLukavac:0,
      totalAnswerTime:0,
      eliminated:false
    });

    startLobby();
  })
  .catch(e=>{ console.error("Auth error:",e); alert("Greška s autentifikacijom."); });

/* ===================== LOBBY ===================== */
const lobbyInfo = document.getElementById("lobbyInfo");
const roundInfoEl = document.getElementById("roundInfo");
const valueInfoEl = document.getElementById("valueInfo");
const questionText = document.getElementById("questionText");
const answerButtons = document.getElementById("answerButtons");
const timerEl = document.getElementById("timer");

let currentRound=1, currentQuestionIndex=0, currentCorrect="", questionStartTime=0;
const rounds=6, questionsPerRound=10;
const baseExclamValue=100; // raste po krugu

/* ===================== PITANJA ===================== */
// 60 pitanja (6 krugova × 10 pitanja) – isto kao u prethodnoj verziji
// allQuestions = [...]; // kopiraj listu pitanja iz prethodnog primjera

/* ===================== LOBBY + START ===================== */
const quizStartTime = new Date("2026-01-10T14:25:00+01:00").getTime();

function startLobby(){
  const interval = setInterval(()=>{
    const now = Date.now();
    if(now >= quizStartTime){
      clearInterval(interval);
      startQuestion();
    } else {
      const diff = Math.floor((quizStartTime - now)/1000);
      lobbyInfo.innerText = `Kviz počinje za ${diff} sekundi`;
    }
  },1000);
}

/* ===================== DALJE ===================== */
// Ovdje ide kompletna logika za:
// - startQuestion()
// - startMainTimer() 20s
// - answerMain() ! . ?
// - startLukavacPhase() 10s
// - answerLukavac()
// - autoFailLukavac()
// - showResultsPhase()
// - pauseBeforeNextRound() 3 minute
// - calculatePoints()
// - updateLeaderboardTable()
// - updateScoreChart()
// - eliminateLowestPlayer()

// Svi funkcionalnosti su iste kao u verziji koju sam ti prethodno pripremio
</script>
</body>
</html>
